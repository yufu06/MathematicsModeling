# 建模思路

## 求解立木含碳量

### 模型建立

**异速生长方程**是建立含碳量模型的常用方法，该方法利用林木易测因子（如胸径、树高）推算不宜测定的立木含碳量，能够减少含碳量估算的外业工作。我们使用基于胸径$D$和树高$H$变量的异速生长模型预测立木含碳量。此外，为了满足立木各分项含碳量之和等于总碳量这一逻辑关系，需要模型间满足可加性的逻辑关系，即构建可加性含碳量模型。可加性模型的参数估计使用非线性似乎不相关回归（$NSUR$）。

一元模型：
$$
\begin{cases}
W_w =\beta_{w_0}\times D^{\beta_{w1}}\times H^{\beta_{w2}}+\epsilon_w \\ 
W_p =\beta_{p_0}\times D^{\beta_{p1}}\times H^{\beta_{p2}}+\epsilon_p \\ 
W_b =\beta_{b_0}\times D^{\beta_{b1}}\times H^{\beta_{b2}}+\epsilon_b \\ 
W_f =\beta_{f_0}\times D^{\beta_{f1}}\times H^{\beta_{f2}}+\epsilon_f \\ 
W_r =\beta_{r_0}\times D^{\beta_{r1}}\times H^{\beta_{r2}}+\epsilon_r \\ 
W_c=W_b+W_f+\epsilon_r \\
W_a=W_w+W_p+W_b+W_f+\epsilon_a \\
W_t=W_w+W_p+W_b+W_f+W_r+\epsilon_t \\
\end{cases}
$$
其中，$W_w 、W_p 、W_b 、W_f 、W_r 、W_c 、W_a$ 和$W_t$ 分别代表干材含碳量、树皮含碳量、树枝含碳量、树叶含碳量、树根含碳量、树冠含碳量、地上含碳量和总含碳量(kg)，$ε_w 、ε_p 、ε_b 、ε_f 、ε_r 、ε_c 、ε_a$ 和 $ε_t$ 分别为各方程的残差。

含碳量模型普遍存在异方差性，我们采取非线性加权回归消除异方差。由于残差的方差与预测变量相关，可以被描述为$\sigma_i^2=(X_j)^m$，将$e_i^2=(X_j)^m$对数转换求解参数$m$。$e_i$ 为方程利用最小二乘法估计所得到的残差。

### 模型评价

模型拟合可采用“刀切法”对模型进行检验。采用调整后确定系数（$R_a^2$ ）和均方根误差（$RMSE$）两个指标对模型拟合进行评价，并选用平均绝对误差（$MAE$）和平均绝对误差百分比（$MAE%$）作为模型检验指标。

公式如下：

$R_a^2=1-(1-R^2)(\frac{N-1}{N-p})$         

$\text{RMSE}=\sqrt{\text{MSE}}=\frac{\sqrt{\sum_{i=1}^N(Y_i-\hat{Y_i})^2}}{N-p}$   

$e_{i,-i}=(Y_i-\widehat{Y_{i,-i}})$  

$\text{MAE}=\frac{\sum_{i=1}^N |e_{i,-i}|}{N}$   

$\text{MAE\%}=\frac{\sum_{i=1}^N|e_{i,-i}|\times 100}{N}$ 

其中，$N$为样本总数，$Y_i$ 为第$i$个观测值，$\hat{Y}$ 是观测的平均值，$\widehat{Y_{i,-i}}$ 是原始数据删除第$i$个样本观测值后，通过参数模型拟合回归方程计算得出的 $Y_i$的观测值。

### 求解枯落量

$C_{k}=\beta_{k}\times W_r$

其中 $\beta_{k}$  为枯落物生物量占地上生物量的比例，可参考下表。

![](C:\Users\yzh\AppData\Roaming\Typora\typora-user-images\image-20220219102951286.png)

### 求解净初级生产力

建立二次回归模型 $W_{t}=\alpha_cA^2+\beta_cA+\sigma_c$，由最小二乘法得
$$
\left[ \begin{matrix} \sum A_i^4 & \sum A_i^3 & \sum A_i^2\\ \sum A_i^3 & \sum A_i^2 & \sum A_i\\ \sum A_i^2 & \sum A_i & N\\ \end{matrix} \right] \left[\begin{matrix} \alpha_c \\ \beta_c \\ \sigma_c \end{matrix}\right]=\left[\begin{matrix}\sum A_i^2W_{ti} \\ \sum A_iW_{ti} \\ \sum W_{ti} \end{matrix}\right]
$$

### 碳封存量

$C_a=W_t+\frac{\delta W_t}{\delta A}+C_k$

$\mathrm{d}C_a=\mathrm{d}W_t+\mathrm{d}C_k$

### 模型简化

令$D$为胸径，$H$为高度，$A$为树龄，$W$为树木含碳量，则：

$W=\beta_0\times D^{\beta_1}\times H^{\beta_2}$

损失函数选取残差平方和，做二元非线性回归即可。

再求出$W$与$A$的关系：

$W=aA^2+bA+c$

利用最小二乘法求出 $a、b、c$

则森林碳封存量为 $W=n\times W_0 \times (1+k)=n\times(1+k)\times(aA^2+bA+c)=n\times(a'A^2+b'A+c')(***)$

求导得森林固碳速率$V=n\times(2a'A+b')$，得$A=\frac{V-b'n}{2a'n}$，代入$(***)$得$W=na'(\frac{V-b'n}{2a'n})^2+nb'(\frac{V-b'n}{2a'n})+nc'$，等式两端同时对$W$求导得，$1=2na'\frac{V-b'n}{2a'n}\frac{1}{2a'n}\frac{dV}{dW}+\frac{nb'}{2a'n}\frac{dV}{dW}$，整理得微分方程$V\frac{dV}{dW}=2a'n$，解得$V=\sqrt{2a'nW}=\sqrt{2an(1+k)W}$。

其中，$k$随森林优势树种不同而不同，值如下：

![](C:\Users\yzh\AppData\Roaming\Typora\typora-user-images\image-20220219160932892.png)

该结果对后续砍伐树木具有指导意义，即当固碳量达到一定程度后，固碳量的增加对于固碳速率的提升并不大，说明此时种内竞争与种间竞争影响显著，故我们可以将相当一部分林木转化为林产品，同时保证砍伐后，森林仍具有可观的固碳速率。

## 木材碳封存量计算

由于森林生态系统的复杂性和多样性, 森林碳封存计量比较困难, 而且也存在很多不确定性, 但树木是森林的主体, 而干材又是树木的核心部分, 其生物量在整个生态系统中占有绝对的比例, 是森林碳的主要封存器官, 因此森林碳封存的计量常用木材蓄积量作为依据 。

### 简单衰减假设

#### 表达式

定义$M(t)$为产品质量函数：由指数衰减方程得，$\frac{dM}{dt}=-\lambda M(t)$（$\lambda$可用于代表森林产品种类）

解得$M(t)=M_0e^{-\lambda t}$

#### 问题

这一假设认为产品衰减量与产品碳储量成正比例，即峰值衰减率发生在生产后的第一年；而在实际生活中，其衰减量是随着时间而改变的，在整个生命周期内其衰减率成伽马分布（峰值相对正态分布偏左）。同时，该假设认为森林产品无固碳能力，即变化量仅含衰减项。

### 伽马优化

#### 表达式

通过$\frac{dM}{dt}=-M_0Gamma(t,\alpha,\beta)(*)$，等式两边同时对0到$t$积分，得到$M(t)=M_0-M_0\int_0^tGamma(x,\alpha,\beta)dx$。

离散化后得$M_n=M_0-M_0\int_0^tGamma(x,\alpha,\beta)dx$。

#### 添加固碳量

首先为契合实际情况，我们加入代表固碳量的子项，调整指数衰减方程为$\frac{dM}{dt}=A(t)-\lambda M(t)(**)$，其中$A(t)$代表随时间变化的固碳量。

通过$\frac{dM}{dt}=A(t)-\lambda M(t)$，我们可以得到$e^{\lambda t}\frac{dM}{dt}+\lambda e^{\lambda t}M(t)=e^{\lambda t}A(t)$。等式两边同时对0到$t$积分，得到$e^{\lambda t}M(t)=\int_0^te^{\lambda x}A(x)d(x)$，继而得到$M(t)=e^{-\lambda t}\int_0^te^{\lambda x}A(x)d(x)$。代入$(**)$得到，$\frac{dM}{dt}=A(t)-\lambda e^{-\lambda t}\int_0^te^{\lambda x}A(x)d(x)=A(t)-\int_0^t\lambda e^{-\lambda(t-x)}A(x)dx=A(t)-\int_0^t\lambda e^{-\lambda x}A(t-x)d(x)$。

注意到，$\lambda e^{-\lambda x}$为指数分布分布密度，我们将其替换伽马分布分布密度$Gamma(x,\alpha,\beta)=\frac{1}{\beta^\alpha\Gamma(\alpha)}x^{\alpha-1}e^{-\frac{x}{\beta}}$，其中$\Gamma(\alpha)=\int_0^\infty s^{\alpha-1}e^{-s}ds$，得到$\frac{dM}{dt}=A(t)-\int_0^t\frac{1}{\beta^\alpha\int_0^\infty s^{\alpha-1}e^{-s}ds}x^{\alpha-1}e^{-\frac{x}{\beta}}A(t-x)d(x)$。

#### 离散化

简化起见，假设每年内固碳量恒定，即$A(x)=常数,(i\le x<i+1, i\in N^*)$。

定义$\{M_n\}$为第$n$年产品质量，$\{A_n\}$为第$n$年固碳量：

易得$M_{n}-M_{n-1}=A_{n-1}-\sum\limits_{i=0}^{n-1}A_{n-i}(\int_i^{i+1}Gamma(x,\alpha,\beta)dx)$，求和得$M_n=M_0+\sum\limits_{j=0}^{n-1}A_j-\sum\limits_{j=0}^{n-1}\sum\limits_{i=0}^{j-1}A_{j-i}(\int_i^{i+1}Gamma(x,\alpha,\beta)dx)$。

为方便起见，假设$A_n=kM_n$，调整推导过程得到$M_n=M_0+k\sum\limits_{j=0}^{n-1}M_j-k\sum\limits_{j=0}^{n-1}\sum\limits_{i=0}^{j-1}M_{j-i}(\int_i^{i+1}Gamma(x,\alpha,\beta)dx)$，从而可迭代求解第$n$年产品质量，而$k,\alpha,\beta$由产品材料决定。

### 参数估计

为方便起见，我们选用不含固碳量的表达式$M_n=M_0-M_0\int_0^tGamma(x,\alpha,\beta)dx$，该表示中含$x,\alpha,\beta$三个参数，下文将介绍对$\alpha,\beta$的极大似然估计。

![image-20220218142511650](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20220218142511650.png)

设$x_1,x_2,\cdots,x_n$是来自总体的样本，根据极大似然估计，设似然函数为$L(x_1,x_2,\cdots,x_n;\alpha,\beta)=\prod\limits_{i=1}^n[\frac{1}{\beta^\alpha \Gamma(\alpha)}x_i^{\alpha-1}e^{-\frac{x}{\beta}}]=[\Gamma(\alpha)]^{-n}\beta^{-n\alpha}[\prod\limits_{i=1}^nx_i]^{\alpha-1}e^{-\frac{1}{\beta}\sum\limits_{i=1}^nx_i}$。

取对数得$\ln L(x_1,x_2,\cdots,x_n;\alpha,\beta)=-n\ln\Gamma(\alpha)-n\alpha\ln\beta+(\alpha-1)\sum\limits_{i=1}^n\ln x_i-\frac{1}{\beta}\sum\limits_{i=1}^nx_i$。

可知似然方程组为$\begin{cases}f_1(\alpha,\beta)=\frac{\partial\ln L(x_1,x_2,\cdots,x_n;\alpha,\beta)}{\partial\alpha}=-n\varphi(\alpha)-n\ln\beta+\sum\limits_{i=1}^n\ln x_i=0\\f_2(\alpha,\beta)=\frac{\partial\ln L(x_1,x_2,\cdots,x_n;\alpha,\beta)}{\partial\beta}=-n\frac{\alpha}{\beta}+\frac{1}{\beta^2}\sum\limits_{i=1}^nx_i=0\end{cases}$

其中$\varphi=\frac{d[\ln\Gamma(x)]}{dx}$，且已知伽马分布的极大似然方程比如极大似然解。

#### 牛顿—拉夫森算法

记$\theta=(\alpha,\beta)^T$，根据初始值$\theta_0=(\alpha_0,\beta_0)^T$，根据牛顿—拉夫森算法原理，有$\theta_{k+1}$与$\theta_k$满足如下递推式：$\theta_{k+1}=\theta_k-J^{-1}(\alpha_k,\beta_k)F(\alpha_k,\beta_k)$。其中，$$F(\alpha_k,\beta_k)=\begin{bmatrix}f_1(\alpha_k,\beta_k)\\f_2(\alpha_k,\beta_k)\end{bmatrix}$$，$J(\alpha_k,\beta_k)=\begin{bmatrix}\frac{\partial}{\partial\alpha}f_1(\alpha_k,\beta_k)&\frac{\partial}{\partial\beta}f_1(\alpha_k,\beta_k)\\\frac{\partial}{\partial\alpha}f_2(\alpha_k,\beta_k)&\frac{\partial}{\partial\beta}f_2(\alpha_k,\beta_k)\end{bmatrix}$

引入修正因子$\lambda(0<\lambda<1)$，将第$k+1$次迭代的结果$\theta_{k+1}$修正为$\theta_{k+1}=\lambda\theta_{k+1}+(1-\lambda)\theta_k$。

牛顿—拉夫森算法的具体步骤为：

1. 选定初始值、容许误差和最大迭代次数；
2. 计算函数值$F(\theta_k)$和$J(\theta_k)$；
3. 利用迭代公式$\theta_{k+1}=\theta-J(\alpha_k,\beta_k)^{-1}F(\alpha_k,\beta_k)$，计算下一步迭代值$\theta_{k+1}$；
4. 利用公式$\theta_{k+1}=\lambda\theta_{k+1}+(1-\lambda)\theta_k$对迭代值$\theta_{k+1}$进行修正；
5. 若误差小于容许误差或迭代次数大于最大迭代次数时，算法停止；否则返回第2步。

## 碳封存策略

为方便起见，我们假设：

1. 初始状态林产品质量为0。
2. 被砍伐的树木完全转发为林产品。
3. 给定时间$t_0$，则中间仅有一次森林树木到林产品的转换，转换时间与质量待定。

（以下内容待补充）

设$M_0^{forest}+M_0^{product}=M_0(定值)$，则$F(M_0^{product};t)=$，令$\frac{\partial F}{\partial M_0^{forest}}=0$，解得：

## 平衡效益的森林管理决策模型

### 参考指标

首先我们为衡量以下不同方面的条件，设计六个指标：

1. 环境质量
2. 生物多样性
3. 经济水平
4. 当地价值观取向
5. 森林恢复能力
6. 森林碳封存能力

#### 环境质量

由于森林砍伐主要导致温室效应、水土破坏，故我们设计的指标应至少考虑大气质量以及区域水质。

定义水质质量指数$PI_{water}=\sum\limits_{i=1}^n\frac{C_i}{C_{0i}}$，其中$C_i$为各种污染物测定值，$C_{0i}$为地面水各污染物最高容许标准；大气质量指数$PI_{air}=\sqrt{max(\frac{C_1}{C_{01}},\frac{C_2}{C_{02}},\cdots,\frac{C_n}{C_{0n}})}\times\sqrt{(\frac{1}{n}\sum\limits_{i=1}^n\frac{C_i}{C_{0i}})}$，其中$C_i$和$C_{0i}$意义同水质质量指数，此式不仅考虑了$\frac{C_i}{C_{0i}}$的平均值，还考虑了其最大值，即兼顾某种污染物出现的高浓度污染；环境质量综合指数$PI_M=\frac{1}{n}\sum\limits_{i=1}^nW_iPI_{i}$，其中$j$为环境影响要素，我们选取大气、地面水两要素；$W$为权重，根据文献$[环境质量指数的计算]$，大气取0.6，地面水取0.1。若$PI_M>0.75$，则说明环境质量较差，不宜砍伐。

##### 问题

季节对于环境质量综合指数存在影响，可能产生误差。

#### 生物多样性

由于我们考虑到各地生物多样性存在差异，统一比较绝对值并不合理，因此主要关注生物多样性的平均变化速率。我们用于衡量生物多样性的指标是$Shannon-wienner$指数$H=-\sum\limits_{i=1}^sp_i\ln p_i$，其中$p_i=\frac{n_i}{N}$代表第$i$个物种的相对多度。定义$h(t)=\frac{H_{after}-H_{before}}{t}$，其中$H_{before}$和$H_{after}$分别是根据第一次观测与第二次观测得到的$Shannon-wienner$指数，而$h(t)$代表在观测区间内，$Shannon-wienner$指数的平均变化速率。

##### 问题

在不同观测时间内取等长观测区间，得到的$Shannon-wienner$指数平均变化速率可能存在差异。

#### 经济水平

森林砍伐可能会影响当地居民森林相关的经济来源，而非森林相关的经济来源会导致居民对森林砍伐的适应程度不同，故我们将当地人均森林相关经济水平$\overline{E_{forest-related}}$与人均非森林相关经济水平$\overline{E_{forest-unrelated}}$加权求和，得到我们用于衡量当地经济水平的指标$E=\lambda\overline{E_{forest-related}}+\mu\overline{E_{forest-unrelated}}$。

#### 当地价值观取向

该项不易于通过表达式量化，故我们构造$bool$表达式$Permit=\neg(民族观念严禁砍伐\or 森林为物质文化遗产\or森林具有旅游价值)$，若$Permit$为1，则允许砍伐（但最终不一定砍伐）；若$Permit$为0，则最终一定不会砍伐。

#### 森林恢复能力

定义树种重要值$I_v=\frac{(相对密度+相对频度+相对优势度)}{3}$，森林构成指数$C_I=\sum Iv\times C_{AN}$，其中$Iv$为各乔木树种重要值（乔木为顶级群落主要组成成分），$C_{AN}$为各乔木树种的顶极适应系数，进而引出结构—多样性指数$C_{SID}=H\times\ln (C_I\times B_A)^2$，其中$H$为$Shannon-wie-ner$指数，$C_I$为森林构成指数，$B_A$为总胸高断断面积。根据文献$[帽儿山地区退化森林生态系统恢复能力评价]$规定一种合理的评价标准为：$C_{SID}>15$为健康林分；$9<C_{SID}\le 15$为亚健康林分，恢复能力最强，一般为6~10年左右；$4<C_{SID}\le 9$为不健康林分；$0\le C_{SID}\le4$为极不健康林分，恢复能力最弱，一般为20年左右。（下文决策模型假设在一定砍伐限度内，健康林分6年可恢复如初，亚健康林分10年恢复，不健康林分与极不健康林分需20年恢复）

#### 森林碳封存能力

我们为衡量森林砍伐对森林碳封存能力的扰动，针对该森林优势种引入指标$M_{c}=M_{before}-M_{after}+T(\overline{P(M_{before})}-\overline{P(M_{after})})$，其中$M_{before}$、$M_{after}$分别为我们观测对象的初、末碳封存量，简化起见，$\overline{P(M_{before})}=\frac{1}{2}(M_{before}+M_{before+T})$、$\overline{P(M_{after})}=\frac{1}{2}(M_{after}+M_{after+T})$，$P(x)$为固碳速率关于碳封存量的函数，$T$为观测间隔，一般选用5年，考虑到5年内成年树木长势趋缓，故我们可使用均值计算平均固碳速率。

### 森林管理模型

首先通过环境质量、生物多样性以及当地价值观取向判断是否具有砍伐条件，进而利用经济水平、森林恢复能力、森林碳封存能力计算最佳砍伐时间，砍伐面积，砍伐区域优先级，过程如下：

（待补充）

